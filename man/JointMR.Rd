% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/JointMR.R
\name{JointMR}
\alias{JointMR}
\title{JointMR}
\usage{
JointMR(
  exposure_list,
  outcome_list,
  original_outcome_list,
  N_list,
  ancestry,
  bootstrap_time
)
}
\arguments{
\item{exposure_list}{A list of exposure GWAS summary statistics datasets that have
been pre-processed for SNP alignment. Each data frame should contain the following
columns: SNP (rsID), effect_allele, other_allele, beta, se, pval.}

\item{outcome_list}{A list of outcome GWAS summary statistics datasets that have
been pre-processed to match the SNPs in the exposure_list. Each data frame should
contain the same columns as exposure_list.}

\item{original_outcome_list}{A list of complete outcome GWAS summary statistics datasets
without SNP filtering. Used for LDSC analysis. Each data frame should contain:
SNP (rsID), effect_allele, other_allele, beta, se, pval.}

\item{N_list}{A named list of sample sizes for each outcome dataset. Names should
correspond to the names in original_outcome_list.}

\item{ancestry}{Character string specifying the ancestry of the study population.
Used for LDSC reference panel selection (e.g., "EUR", "EAS", "AFR", "SAS", "mixed").}

\item{bootstrap_time}{Integer specifying the number of bootstrap iterations for
standard error estimation. Typically 1000-10000 iterations.}
}
\value{
A list containing:
  \item{theta}{The joint MR estimate (causal effect).}
  \item{se}{Bootstrap standard error of the estimate.}
  \item{pvalue}{Two-sided p-value for the estimate.}
  \item{nSNP}{Number of SNPs used in the analysis.}
  \item{cor_matrix}{Genetic correlation matrix estimated from LDSC.}
}
\description{
A joint likelihood-based approach designed to integrate multiple GWAS summary databases
while explicitly accounting for the covariance matrix of the Wald ratio estimates. Details refer to
JointMR: A joint likelihood-based approach for causal effect estimation in overlapping Mendelian Randomization studies
Summary Datasets by  Sijia Wu, Lei Hou, Zhongshang Yuan, Xiaoru Sun, Yuanyuan Yu, Hao Chen, Lin Huang,Hongkai Li, Fuzhong Xue
}
\details{
The function performs the following steps:
1. Applies MR-Egger regression to each exposure-outcome pair to estimate
   and correct for horizontal pleiotropy (intercept).
2. Computes Wald ratios for each SNP, adjusted for pleiotropy.
3. Uses LDSC to estimate genetic correlations between outcomes.
4. Constructs a covariance matrix incorporating SNP-specific variances,
   between-outcome genetic correlations, and between-study heterogeneity (tauÂ²).
5. Computes a maximum likelihood estimate (MLE) of the joint causal effect.
6. Estimates standard errors using bootstrap resampling of SNPs.
}
\note{
Required R packages: MASS (for ginv), TwoSampleMR (for mr_egger_regression),
and ldscr (for ldsc_rg, available from GitHub: jean997/ldsc). Ensure these
packages are installed and loaded before running the function.
}
\examples{
#load("exposure_list_trimmed.Rdata")
#load("outcome_list_example.Rdata")
#load("outcome_list_all.Rdata")

#N_list_example <- list(
#finn    = 486367,
#MVP       = 432648,
#EPIC      = 22326)

#JointMR(exposure_list = exposure_list_trimmed,
#outcome_list = outcome_list_example,
#original_outcome_list = outcome_list_all,
#N_list = N_list_example,
#ancestry = "EUR",
#bootstrap_time = 1000)
}
